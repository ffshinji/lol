<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FFLegendsHub | Sezonlar</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="dashboard.html" class="logo">
                    <img src="https://i.hizliresim.com/h701fas.jpg" class="logo-icon" alt="FF">
                    <span class="logo-text">FFLegendsHub</span>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Ana Men√º</div>
                    <a href="index.html" class="nav-link"><span class="nav-emoji">üìä</span><span>√ñnizleme</span></a>
                    <a href="players.html" class="nav-link"><span class="nav-emoji">üë•</span><span>Oyuncular</span></a>
                    <a href="matches.html" class="nav-link"><span class="nav-emoji">üìú</span><span>Ge√ßmi≈ü
                            Ma√ßlar</span></a>
                    <a href="draft.html" class="nav-link">
                        <span class="nav-emoji">‚öîÔ∏è</span>
                        <span>Draft Yap</span>
                    </a>
                    <a href="rivalry.html" class="nav-link">
                        <span class="nav-emoji">‚öñÔ∏è</span>
                        <span>Rekabet (H2H)</span>
                    </a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">ƒ∞statistikler</div>
                    <a href="leaderboard.html" class="nav-link"><span class="nav-emoji">üèÜ</span><span>Liderlik
                            Tablosu</span></a>
                    <a href="champions.html" class="nav-link"><span
                            class="nav-emoji">‚≠ê</span><span>≈ûampiyonlar</span></a>
                    <a href="seasons.html" class="nav-link active"><span
                            class="nav-emoji">üìÖ</span><span>Sezonlar</span></a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Sistem</div>
                    <a href="settings.html" class="nav-link"><span class="nav-emoji">‚öôÔ∏è</span><span>Ayarlar</span></a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">üìÖ Sezon Ge√ßmi≈üi</h1>
                <p class="page-description">Ge√ßmi≈ü sezonlarƒ± g√∂r√ºnt√ºle ve y√∂net.</p>
            </div>

            <div class="grid grid-cols-3 gap-6" id="seasons-grid">
                <!-- Seasons will be loaded here -->
            </div>

        </main>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js?v=2"></script>
    <script src="js/db.js?v=2"></script>
    <script src="js/stats.js?v=2"></script>
    <script src="js/app.js?v=2"></script>
    <script src="js/gemini.js?v=2"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DB init is handled in db.js or app.js usually, but we ensure it here
            DB.init();
            renderSeasons();
        });

        function renderSeasons() {
            const grid = document.getElementById('seasons-grid');
            if (!grid) return;

            const seasons = DB.data.archivedSeasons || {};
            let html = '';

            // Add Current Season Card
            const currentMatchCount = DB.data.matches ? DB.data.matches.filter(m => !m.season).length : 0;
            const currentPlayerCount = DB.data.players ? DB.data.players.length : 0;

            html += `
                <div class="card season-card current" style="border: 1px solid var(--primary); background: rgba(var(--primary-rgb), 0.1);">
                    <div class="card-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <h3 style="margin:0;">Mevcut Sezon</h3>
                        <span class="badge badge-success" style="background:var(--green); color:#fff; padding:2px 8px; border-radius:4px; font-size:12px;">Aktif</span>
                    </div>
                    <div class="card-body">
                        <p class="text-muted">≈ûu an oynanan sezon.</p>
                        <div class="stats-summary" style="margin: 15px 0;">
                            <div><strong>${currentMatchCount}</strong> Ma√ß</div>
                            <div><strong>${currentPlayerCount}</strong> Oyuncu</div>
                        </div>
                        <button class="btn btn-secondary btn-sm btn-block" onclick="window.location.href='index.html'" style="width:100%">G√∂r√ºnt√ºle</button>
                    </div>
                </div>
            `;

            // Sort seasons
            Object.values(seasons).reverse().forEach(s => {
                html += `
                    <div class="card season-card">
                        <div class="card-header" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                            <h3 style="margin:0;">${s.id}</h3>
                            <span class="badge badge-secondary" style="background:#666; color:#fff; padding:2px 8px; border-radius:4px; font-size:12px;">Ar≈üiv</span>
                        </div>
                        <div class="card-body">
                            <p class="text-muted" style="font-size:12px;">Ar≈üivlenme: ${new Date(s.date).toLocaleDateString()}</p>
                            <div class="stats-summary" style="margin: 15px 0;">
                                <div><strong>${s.matches || 0}</strong> Ma√ß</div>
                                <div><strong>${s.playerCount || (s.leaderboard ? s.leaderboard.length : 0)}</strong> Oyuncu</div>
                            </div>
                            <button class="btn btn-outline btn-sm btn-block" onclick="viewSeason('${s.id}')" style="width:100%">ƒ∞ncele</button>
                        </div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function viewSeason(id) {
            window.location.href = `leaderboard.html?season=${encodeURIComponent(id)}`;
        }
    </script>
</body>

</html>